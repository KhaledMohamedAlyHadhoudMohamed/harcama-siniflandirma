import pandas as pd
from sklearn.feature_extraction.text import TfidfVectorizer
from gensim.models import Word2Vec
import joblib
import re
import os

# Veriyi yÃ¼kle
df = pd.read_csv("harcama_aciklamalari_raw.csv")

# Temizleyici fonksiyon
def clean(text):
    text = text.upper()
    text = re.sub(r"[^A-ZÃ‡ÄžÄ°Ã–ÅžÃœ\s]", "", text)
    return text.split()

# CÃ¼mleleri tokenize et
sentences = df["text"].apply(clean).tolist()

# âœ… Word2Vec EÄŸitimi
print("ðŸ”„ Word2Vec modeli eÄŸitiliyor...")
w2v_model = Word2Vec(sentences=sentences, vector_size=50, window=5, sg=0, min_count=1, workers=4)
w2v_model.save("word2vec_cbow_50.model")
print("âœ… Word2Vec CBOW modeli kaydedildi: word2vec_cbow_50.model")

# âœ… TF-IDF EÄŸitimi
print("ðŸ”„ TF-IDF modeli eÄŸitiliyor...")
texts = df["text"].astype(str).tolist()
tfidf = TfidfVectorizer()
tfidf_matrix = tfidf.fit_transform(texts)
joblib.dump(tfidf, "tfidf_model.pkl")
print("âœ… TF-IDF modeli kaydedildi: tfidf_model.pkl")
